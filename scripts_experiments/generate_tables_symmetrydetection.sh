#!/usr/bin/env bash

TABLETYPE=${1}			# optional argument: if supplied, print full information

if [ -z $TABLETYPE ]
then
    TESTSETSA=( packing_sym0 kissing_sym0 energy_sym0 maxcut )
    TESTSETSB=( miplib2017 minlplib sat2002 )

    echo "\begin{table}[t]"
    echo "  \caption{Statistics on how many instances allow for a particular symmetry handling method.}"
    echo "  \label{tab:statistics}"
    echo "  \centering"
    echo "  \begin{tabular*}{\textwidth}{@{}l@{\;\;\extracolsep{\fill}}rrrrrrrrr@{}}"
    echo "    \toprule"
    echo "    & \multicolumn{2}{c}{\# instances} & \multicolumn{2}{c}{generators} & \multicolumn{2}{c}{row + column} & \multicolumn{2}{c}{row/column} & \\\\"
    echo "    \cmidrule{2-3} \cmidrule{4-5} \cmidrule{6-7} \cmidrule{8-9}"
    echo "    test set & total & sym. & sig. & unsig. & sig. & unsig. & sig. & unsig. & simple\\\\"
    echo "    \midrule"
    echo "    \multicolumn{10}{@{}l}{structured instances:}\\\\"
    for T in ${TESTSETSA[@]}
    do
	./evaluate_symmetry_statistics.py ../results/symmetry_statistics/check.$T.scip-10.0.0.0.linux.x86_64.gnu.opt.spx2.none.moskito.sym_1_doublelex_1_reflection_1_simple_1.out $T
    done
    echo "    \midrule"
    echo "    \multicolumn{10}{@{}l}{benchmarking instances:}\\\\"
    for T in ${TESTSETSB[@]}
    do
	./evaluate_symmetry_statistics.py ../results/symmetry_statistics/check.$T.scip-10.0.0.0.linux.x86_64.gnu.opt.spx2.none.moskito.sym_1_doublelex_1_reflection_1_simple_1.out $T
    done
    echo "    \bottomrule"
    echo "  \end{tabular*}"
    echo "\end{table}"
else
    TESTSETS=( packing_sym0 kissing_sym0 energy_sym0 maxcut miplib2017 minlplib sat2002 )

    for T in ${TESTSETS[@]}
    do
	echo "% generated by generate_tables_symmetrydetection.sh"
	echo "\begin{scriptsize}"
	echo "  \begin{longtable}{@{}l@{\;\;\extracolsep{\fill}}R{9cm}@{}}"
	echo "    \caption{Statistics on which symmetry handling methods apply to which instance of the ${T} test set.}"
	echo "    \label{tab:stats${T}}\\\\"
	echo "    \toprule"
        echo "    % first header"
        echo "    instance & structured symmetries\\\\"
        echo "    \midrule"
        echo "    \endfirsthead"
        echo "    % header"
        echo "    instance & structured symmetries\\\\"
        echo "    \midrule"
        echo "    \endhead"
        echo "    % footer"
        echo "    \midrule"
        echo "    \endfoot"
        echo "    % last footer"
        echo "    \bottomrule"
        echo "    \endlastfoot"
	./evaluate_symmetry_statistics.py ../results/symmetry_statistics/check.$T.scip-10.0.0.0.linux.x86_64.gnu.opt.spx2.none.moskito.sym_1_doublelex_1_reflection_1_simple_1.out $T --full
	echo "  \end{longtable}"
	echo "\end{scriptsize}"
    done
fi
